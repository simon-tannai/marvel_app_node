"use strict";const path=require("path"),express=require("express"),helmet=require("helmet"),bodyParser=require("body-parser"),cors=require("cors"),morgan=require("morgan"),logger=require(path.join(__dirname,"core","Logger.js")),fs=require("fs"),app=express(),port=8080;if(app.use(helmet()),app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!0})),app.use(cors()),app.use(express.static(path.join(__dirname,"webapp"))),"production"===process.env.NODE_ENV){const e=require("file-stream-rotator");let r=path.join(__dirname,"logs");fs.existsSync(r)||fs.mkdirSync(r);let s=e.getStream({date_format:"YYYY-MM-DD",filename:path.join(r,"access-%DATE%.log"),frequency:"daily",verbose:!1});app.use(morgan("combined",{stream:s}))}else app.use(morgan("combined"));app.get("/",(e,r)=>{r.status(200).send("May the force be with you.")});const marvelRouter=require(path.join(__dirname,"bundles","marvel","marvelRouter.js"));app.use("/marvel",marvelRouter);let srv=app.listen(8080,()=>{logger.info(`Server run on port 8080 in ${process.env.NODE_ENV} mode`)});module.exports=srv;